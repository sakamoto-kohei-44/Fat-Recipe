# [GainMate]
## サービス概要
「GainMate」は、食が細い、あるいは体質的に痩せ型の人々が
健康的な体重増加を目指し、標準体型、さらには細マッチョになるための
サポートを行う食事特化型サービスです。

##　想定されるユーザー層
・10代～40代のある程度料理ができる男女。
・食事の量が少なく、体が細く悩んでいる人。
・食事を増やしても、なかなか体重が増えない人。
・細マッチョに憧れて食生活を見直したい人。
・標準体重を目指しているが、方法がわからない人。
## サービスコンセプト
多くの人が体重を落としたいと考える現代社会ですが、体重を増やしたいと感じている人も多く存在します。
特に、食事の量や質に挑戦している人、体質的に太りにくいと感じている人が、ただ増量を目的とした食事を取るだけでは十分な結果を得ることはなかなか難しいです。
栄養バランス、カロリー摂取量、食事のタイミングや頻度など、体重を増やすための効果的なアプローチには幅広い知識が求められます。
そこで、標準体重に近づきたい人や細マッチョを目指す人向けに、食事に特化した情報とサポートを提供するサービスを提案します。
売りや差別化のポイントとしては
・ほとんどの健康・食事アプリは減量をメインにしていますが、このサービスは増量を目指す人に特化している点が最大の売りです。
・ユーザーの体質、目標に応じてカスタマイズされた食事プランのアドバイスを提供することで、一人ひとりのニーズに合わせたサポートを実現します。
・メニュー作成時に、自分の苦手な食材と好きな食材を指定することでユーザーが嫌いな食材を避けながら、それでもバランスの取れた食事プランを提案する。これにより、食事を続けるモチベーションを維持しやすくします。
・単に食事プランを提供するだけでなく、なぜその食材やタイミングが推奨されるのかの理由や背景も提供します。これにより、ユーザーは増量の知識を深めることができ、自分自身での食事選びの基準も養うことができます。
・競合サービスとの差別化ポイントとして、いくつかの献立アプリでは、主に食材を指定して一週間分のレシピをAIが自動生成する機能がメインですが、カロリー管理や増量を目的としたレシピの生成機能はありません。
一方、筋トレアプリではカロリー管理や体重管理をグラフ等で視覚化する機能は備えていますが、増量のための適切なレシピを生成する機能はありません。
このアプリでは、カロリー管理や体重管理をグラフなどで視覚化する機能と、増量のための適切なレシピを生成する機能の両方を組み合わせることで、二つのアプリの長所を取り入れた形となっており、これが最大の差別化ポイントです。

**## サービスの利用イメージ**
* 利用方法
  ・ユーザーが最初にアクセスするとサービス紹介画面とログインボタンを表示させる。
  ・すでに登録してあるGoogleアカウント、LINEでログインさせる。
  ・ユーザー情報を登録する前にアプリを少し触りたい人向けに、ゲストユーザーでもログインできるようにし機能は触れるようにする。
  ・「標準体型を目指す」「細マッチョを目指す」と項目を表示させ目標設定をし、性別、身長、体重、活動レベル、ニックネームを入力させBMI指数を計算する。
  ・そのデータはデータベースに保存しそのデータを元に一日に必要なカロリー等を算出しレシピが提供できるようにする。
  ・画面下部にナビゲーションバーを設ける
  ダッシュボード項目
ユーザーの基本情報（性別、身長、体重、目標体型、現在のBMI指数）を一覧表示。
一日に必要なカロリー、タンパク質、脂質、炭水化物の推奨量をグラフや数値で提示。
ユーザーの体重を週一回入力し、その推移をグラフで比較表示。
週一回入力されていないときはアプリ内で通知をする。

  献立を立てる項目
ユーザーが目標としているカロリーや栄養素を基に、朝、昼、晩の献立の提案。
各食事における料理のレシピや材料、調理方法を詳しく表示。
献立の中から好みの料理を置き換える機能。例：「この料理は好きではない」を選択すると、同じカロリー帯の別の料理を提案。
数日分のレシピをAIが自動生成

  マイレシピ項目
お気に入りのレシピを保存しておける「お気に入りフォルダ」機能。
共有項目にLINEでシェア機能を追加する(不必要なら無くす)

**## 実装を予定している機能**

**### MVP**
* 会員登録
* ログイン/ログアウト機能
* ユーザープロフィールの設定
* アレルギー項目の設定
* 性別、身長、体重、活動レベルの入力
* BMI計算(身長と体重を元にBMIを計算し、ユーザーの現在の状態を示す体重の記録機能)
* 目標設定（標準体重を目指すか、細マッチョを目指すか等）
* カロリーと栄養計算(プロフィール情報を元に必要なカロリー、栄養素を算出)
* ユーザーの情報と目標に合わせた食事プランの提案
* 食事の記録、お気に入りのレシピなどの管理(基本的なCRUD機能)
* MVPの段階では食材の好き嫌いに合わせた数日分のレシピ提供ではなく、一日分の適切なレシピ提供にし、その後拡張させる
* 週一回の体重を入力し、推移をグラフで表示
* アプリ内通知機能
* ステップ入力・確認画面
* マルチ検索・オートコンプリート
  ユーザーが簡単に食材やレシピを検索できるようにする
* ローディングスピナーやプログレスバーの実装: 「レシピを生成中...」のようなメッセージの表示。

**### その後の機能**
* 食材の好き嫌い設定機能：(好きな食材や嫌いな食材を入力)
* 食材の好き嫌いに合わせた3日分の適切なレシピを自動で作成し提案
* LINE認証
* 栄養や食材に関する知識の提供
  なぜ特定の食材やタイミングが推奨されるのかの理由や背景をユーザーに教える
* レコメンド(時間があれば)
  ユーザーの過去の選択や好みに基づいて、レシピや食材をおすすめ
* 献立の中から好みの料理を置き換える機能

**### 使用するAPI**
* Spoonacular API,USDA FoodData Central API: 料理や食材に関する情報を取得できるAPI。ユーザーが設定した食材の好き嫌いや、必要な栄養成分に合わせて検索することが可能
* LINEのAPI

**### 難しそうな部分**
・APIの統合
・献立生成アルゴリズム
・APIの制限
・UX

**### 具体的な実装方法**
* 「ユーザーの情報と目標に合わせた食事プランの提案」
1. 「ユーザーの情報と目標に合わせた食事プランの提案」
ユーザープロフィールの収集:
User モデルには性別、体重、身長などの情報を格納するカラムが含まれる。
フロントエンドでは、これらの情報を入力するフォームを提供。
目標に基づいたカロリー計算:

基礎代謝を計算するロジック（Harris-Benedict方程式など）を用意。
ユーザーの活動レベルに応じて修正し、目標に基づいてカロリー摂取量を算出。
食事プランの生成:

Spoonacular APIから取得したレシピの情報は、Recipe モデルに一時保存。
ユーザーの日々の推奨カロリーを基に、合計カロリーが範囲内に収まるレシピを選択。

実際にPostmanを使ってAPIからどのような情報が返ってくるか試したところ、作り方や含まれる材料が詳しく返ってきました。
https://learn.microsoft.com/ja-jp/connectors/spoonacularrecipeip/
上記サイトを参考にしましたが、色々とアクションがあるので組み合わせることで実装は可能だと思いました。

取得したレシピから適切なカロリーのレシピのフィルタリングに関して下記のような方法で実装できるのではと思いました。(検証行いたかったのですが、フィルタリングできるかは開発に入らないとどのようなレスポンスが返ってくるかわからないと思いました。)
ユーザープロファイルの設定:
ユーザーから情報を収集（年齢、性別、身長、体重、活動レベルなど）
これらの情報を使用して、TDEE（Total Daily Energy Expenditure：1日の総消費エネルギー）を計算。これは、ユーザーが1日に必要とする推定カロリー摂取量を示す。

APIからレシピの情報を取得:
Spoonacular APIを使用して、多数のレシピを取得。
取得した各レシピのカロリー情報を把握。

フィルタリング:
ユーザーのTDEEと比較して、適切なカロリー範囲内のレシピをフィルタリング。例えば、TDEEが2000カロリーであれば、500〜700カロリー程度のレシピを夕食として提案する。
他の栄養成分（たんぱく質、脂質、炭水化物など）も考慮に入れれそうなら入れる。

結果の表示:
フィルタリングされたレシピのリストをユーザーに表示します。

2. 「食材の好き嫌いに合わせた数日分の適切なレシピを自動で作成し提案」
* 食材の好き嫌いの設定:
チェックボックスを使って、ユーザーの食材の好みを収集。
ユーザーはプロフィールで好き・嫌いの食材を選択。
ユーザーが選択できる食材リストはFood モデルから取得。
フロントエンドでは、これらの食材から選択して好き・嫌いを設定できるUIを提供。
レシピ提案時のフィルタリング:

SQLクエリを使用して、Recipe モデルと中間テーブルをJOIN。ユーザーの嫌いな食材を含むレシピを除外。
好きな食材を含むレシピがあれば、それらを優先的に提案リストに追加。

食材のデータの用意:
Spoonacular APIを利用して、初期データをインポート。

レシピ提案時のフィルタリング:
ユーザーが設定した好みを基に、データベース内のレシピをフィルタリング。
嫌いな食材を含むレシピは提案リストから除外。
好きな食材を含むレシピは提案リストの上位に表示。
レシピの表示:

フィルタリングされたレシピをリストとしてユーザーに表示。
各レシピには、材料リスト、調理手順、総カロリーなどの情報が表示される。

**### 画面遷移図**
https://www.figma.com/file/mL0abUN3kCBi2m0N5zho9w/%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3?type=design&node-id=0%3A1&mode=design&t=5YZK4sMShNtMJ1Uk-1

**### 使用技術**
フロントエンド
  Hotwire
  Stimulus Autocomplete
  JavaScript
CSSフレームワーク
  bootstrap
バックエンド
  Ruby on Rails 7.0.7.2
  Ruby 3.2.2
RDS
  PostgreSQL
認証・認可
  Devise
デプロイ
  Render
環境構築
  Docker
バージョン管理
  GitHub
テスティング
   RSpec
   Capybara